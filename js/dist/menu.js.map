{"version":3,"file":"menu.js","sources":["../src/menu.js"],"sourcesContent":["import $ from 'jquery'\nimport Ajax from './ajax'\nimport Confirm from './confirm'\nimport Tool from './tool'\n\nconst NAME = 'menu'\nconst DATA_KEY = 'lyc.menu'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\nconst JQUERY_NO_CONFLICT = $.fn[NAME]\n\nconst Event = {\n  CLICK_DATA_API: `click${EVENT_KEY}${DATA_API_KEY}`,\n  CLICK_CLOSE_DATA_API: `click.close${EVENT_KEY}${DATA_API_KEY}`\n}\n\nconst Customer = {\n  MENUID: 'menuid',\n  URL: 'url',\n  NAME: 'name',\n  ICON: 'icon',\n  CLOSE: 'close',\n  SHOW: 'show',\n  CHECK: 'chk',\n  CUSTOM: 'cus',\n  BEFORE: 'bef',\n  SUCCESS: 'suc',\n  WARN: 'warn'\n}\n\nconst HTML_CONTEXT = {\n  HEADER: `<a class=\"home-page\" href=\"#\" \n            data-${Customer.URL}=\"{{${Customer.URL}}}\"\n            data-${Customer.MENUID}=\"{{${Customer.MENUID}}}\">\n            {{${Customer.ICON}}} {{${Customer.NAME}}} \n            {{${Customer.CLOSE}}}\n            </a>`,\n  BODY: `<div class=\"iframe-content\" data-${Customer.MENUID}=\"{{${Customer.MENUID}}}\"></div>`,\n  CLOSE: '<i class=\"cs cs-guanbi\"></i>'\n}\n\nconst Selector = {\n  MENU_HEADER: '#menu-list',\n  MENU_BODY: '#page-content',\n  ACTIVE: 'active',\n  LEFT_MENU: '.metismenu',\n  CLOSE: '.cs.cs-guanbi',\n  BODY_CLASS: '.iframe-content'\n}\n\n/**\n * ------------------------------------------------------------------------\n *  菜单生产\n *  @author lyc\n *  @date 2020年06月04日17:48:50\n * ------------------------------------------------------------------------\n */\nclass Menu {\n  constructor(element) {\n    this._element = element\n    this.config = this.getConfig()\n    this.init()\n    return this\n  }\n  static get NAME() {\n    return NAME\n  }\n\n  static get Customer() {\n    return Customer\n  }\n\n  getConfig() {\n    const config = $(this._element).data()\n    if (!config[Customer.URL]) {\n      config[Customer.URL] = $(this._element).attr('href')\n    }\n    return config\n  }\n\n  // ----------------------------------------------------------------------\n  // 初始化\n  // ----------------------------------------------------------------------\n  init() {\n    const $header = $(Selector.MENU_HEADER)\n    const $body = $(Selector.MENU_BODY)\n    if ($header.length === 0 || $body.length === 0 || !this.config[Customer.URL]) {\n      return\n    }\n    // 处理事件链 事件顺序:[chk , cus, bef ,suc]\n    const flag = this.chain()\n    if (!flag) { // 为false 直接结束\n      return\n    }\n    const data = this.config\n    // 菜单id不存在 则自动生成一个\n    if (!data[Customer.MENUID]) {\n      data[Customer.MENUID] = `menuid_${new Date().getTime()}`\n      $(this._element).data(Customer.MENUID, data[Customer.MENUID])\n    }\n    const select = `[data-${Customer.MENUID} = ${data[Customer.MENUID]}]`\n    let $a = $header.find(select)\n    if ($a.length === 0) {\n      // 生产头部\n      let headerDiv = HTML_CONTEXT.HEADER\n      headerDiv = headerDiv.replace(new RegExp(`{{${Customer.URL}}}`, 'g'), data[Customer.URL])\n      headerDiv = headerDiv.replace(new RegExp(`{{${Customer.MENUID}}}`, 'g'), data[Customer.MENUID])\n      headerDiv = headerDiv.replace(new RegExp(`{{${Customer.CLOSE}}}`, 'g'), data[Customer.CLOSE] === false ? '' : HTML_CONTEXT.CLOSE)\n      headerDiv = headerDiv.replace(new RegExp(`{{${Customer.ICON}}}`, 'g'), data[Customer.ICON] ? `<i class =\"${data[Customer.ICON]}\"></i>` : '')\n      headerDiv = headerDiv.replace(new RegExp(`{{${Customer.NAME}}}`, 'g'), data[Customer.NAME])\n      $a = $(headerDiv).appendTo($header)\n    } else {\n      $a.trigger($.Event(Event.CLICK_DATA_API))\n      return\n    }\n    $a.data({\n      ...$a.data(),\n      ...this.config\n    })\n    let $b = $body.find(select + Selector.BODY_CLASS)\n    if ($b.find(select).length === 0) {\n      // 生产身体\n      let bodyDiv = HTML_CONTEXT.BODY\n      bodyDiv = bodyDiv.replace(new RegExp(`{{${Customer.MENUID}}}`, 'g'), data[Customer.MENUID])\n      $b = $(bodyDiv).appendTo($body)\n      $b.data({\n        ...$b.data(),\n        ...data\n      })\n    }\n    $a.on(Event.CLICK_DATA_API, this.click)\n    // 直接触发\n    $a.trigger($.Event(Event.CLICK_DATA_API))\n    // 关闭标签 的初始化\n    $a.find(Selector.CLOSE).on(Event.CLICK_CLOSE_DATA_API, this.closeLable)\n  }\n\n  // ----------------------------------------------------------------------\n  // 事件顺序:[chk , cus, bef ,suc]\n  // ----------------------------------------------------------------------\n  chain() {\n    const chk = Tool.eval(this.config[Customer.CHECK])\n    if (typeof chk === 'function') {\n      const flag = chk($(this._element), this.config)\n      if (typeof flag === 'boolean' && !flag) {\n        return false\n      }\n    }\n    // 自定义函数式  用于封装数据\n    const cus = Tool.eval(this.config[Customer.CUSTOM])\n    if (cus && typeof cus === 'object' && typeof cus.fuc === 'function') {\n      const rescus = cus.fuc.call(this._element, ...cus.args)\n      if (rescus && typeof rescus === 'object') {\n        this.config = {\n          ...this.config,\n          ...rescus\n        }\n      } else if (typeof rescus === 'boolean' && !rescus) {\n        return false\n      } else {\n        return false\n      }\n    }\n\n    const warn = this.config[Customer.WARN]\n    if (warn) {\n      const confirm = new Confirm(warn)\n      confirm.ok(() => this._chainOver($(this._element), this.config)).show()\n    } else {\n      this._chainOver($(this._element), this.config)\n    }\n    return true\n  }\n\n  _chainOver($this, config) {\n    const bef = Tool.eval(config[Customer.BEFORE])\n    if (typeof bef === 'function') {\n      const obj = bef($this, config)\n      this.config = {\n        ...config,\n        ...typeof obj === 'object' && obj ? obj : {}\n      }\n    }\n    this.config[Customer.SUCCESS] = Tool.eval(config[Customer.SUCCESS])\n  }\n\n  // ----------------------------------------------------------------------\n  // i标签关闭功能触发\n  // ----------------------------------------------------------------------\n  closeLable(event) {\n    if (event) {\n      event.preventDefault()\n    }\n    // 1头部操作\n    const $this = $(event.target)\n    const $a = $this.closest('a')\n    const data = $a.data()\n    Menu.close(data[Customer.MENUID])\n  }\n\n  // ----------------------------------------------------------------------\n  // a标签点击功能触发\n  // ----------------------------------------------------------------------\n  click(event) {\n    if (event) {\n      event.preventDefault()\n    }\n    const $this = $(event.currentTarget)\n    const data = $this.data()\n    Menu.open(data[Customer.MENUID])\n  }\n\n  // ----------------------------------------------------------------------\n  // 通过menuid关闭菜单\n  // ----------------------------------------------------------------------\n  static close(menuId) {\n    if (!menuId) {\n      const $header = $(Selector.MENU_HEADER)\n      const $a = $header.find(`a.${Selector.ACTIVE}`)\n      menuId = $a.data(Customer.MENUID)\n    }\n    if (!menuId) {\n      return\n    }\n    // 1头部操作\n    const select = `[data-${Customer.MENUID} = ${menuId}]`\n    const $a = $(Selector.MENU_HEADER).find(select)\n    // 关闭之后默认获取最近的一个\n    // eslint-disable-next-line no-nested-ternary\n    const $round = $a.prev().length !== 0 ? $a.prev() : $a.next().length !== 0 ? $a.next() : null\n    const $preva = $a.hasClass(Selector.ACTIVE) ? $round : null\n    const $body = $(Selector.MENU_BODY).find(select + Selector.BODY_CLASS).eq(0)\n    // 关闭自身\n    $a.remove()\n    $body.remove()\n\n    if ($preva && $preva.length !== 0) {\n      $preva.addClass(Selector.ACTIVE)\n      const prevSelect = `[data-${Customer.MENUID} = ${$preva.data(Customer.MENUID)}]${Selector.BODY_CLASS}`\n      const $prevbody = $(Selector.MENU_BODY).find(prevSelect).eq(0)\n      $prevbody.addClass(Selector.ACTIVE)\n    }\n  }\n\n  // ----------------------------------------------------------------------\n  // 通过menuid关闭其他菜单\n  // ----------------------------------------------------------------------\n  static closeOther(menuId) {\n    const $header = $(Selector.MENU_HEADER)\n    if (!menuId) {\n      const $a = $header.find(`a.${Selector.ACTIVE}`)\n      menuId = $a.data(Customer.MENUID)\n    }\n    $header.find('a').each((_index, ele) => {\n      const flag = $(ele).data(Customer.CLOSE)\n      const id = $(ele).data(Customer.MENUID)\n      if (flag !== false && id !== menuId) {\n        Menu.close(id)\n      }\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  // 关闭全部菜单， 除了不可关闭的\n  // ----------------------------------------------------------------------\n  static closeAll() {\n    const $header = $(Selector.MENU_HEADER)\n    $header.find('a').each((_index, ele) => {\n      const flag = $(ele).data(Customer.CLOSE)\n      const menuid = $(ele).data(Customer.MENUID)\n      if (flag !== false) {\n        Menu.close(menuid)\n      }\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  // 通过menuid打开菜单\n  // ----------------------------------------------------------------------\n  static open(menuId, flag) {\n    const $header = $(Selector.MENU_HEADER)\n    if (!menuId) {\n      const $a = $header.find(`a.${Selector.ACTIVE}`)\n      menuId = $a.data(Customer.MENUID)\n    }\n    if (!menuId) {\n      return\n    }\n    const select = `[data-${Customer.MENUID} = ${menuId}]`\n    const $this = $(Selector.MENU_HEADER).find(select)\n    // 1.1隐藏其他\n    $this.siblings().removeClass(Selector.ACTIVE)\n    // 1.2显示自己\n    $this.addClass(Selector.ACTIVE)\n    // 1.3关联菜单操作\n    const menu = $(Selector.LEFT_MENU)\n    menu.find('li,a').removeClass(Selector.ACTIVE)\n    const menu$a = menu.find(select).eq(0)\n    menu$a.addClass(Selector.ACTIVE)\n    // 2身体操作\n    const $body = $(Selector.MENU_BODY).find(select + Selector.BODY_CLASS).eq(0)\n    // 2.1隐藏其他\n    $body.siblings().removeClass(Selector.ACTIVE)\n    // 2.2显示自己\n    $body.addClass(Selector.ACTIVE)\n    // jq深复制\n    const bData = $.extend(true, {}, $body.data())\n    const show = bData[Customer.SHOW] || false\n    const array = []\n    for (const ckey in Customer) {\n      if (array.indexOf(Customer[ckey]) < 0) {\n        array.push(Customer[ckey])\n      }\n    }\n    for (const key in bData) {\n      if (array.indexOf(key) > -1) {\n        delete bData[key]\n      }\n    }\n    if (!show || flag === true) {\n      Ajax.getHTML($body.data(Customer.URL), bData, Menu.suc($this, $body), Menu.err(menuId))\n    }\n  }\n\n  static suc($header, $body) {\n    const config = $header.data()\n    const suc = config[Customer.SUCCESS]\n    return (result) => {\n      $body.data(Customer.SHOW, true)\n      const content = $body.html(result)\n      content.initUI()\n      if (typeof suc === 'function') {\n        suc($(content), config)\n      }\n    }\n  }\n\n  static err(menuId) {\n    return () => {\n      Menu.close(menuId)\n    }\n  }\n\n  static _jQueryInterface() {\n    return new Menu(this)\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n$.fn[NAME] = Menu._jQueryInterface\n$.fn[NAME].Constructor = Menu\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return Menu._jQueryInterface\n}\n\nexport default Menu\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","JQUERY_NO_CONFLICT","$","fn","Event","CLICK_DATA_API","CLICK_CLOSE_DATA_API","Customer","MENUID","URL","ICON","CLOSE","SHOW","CHECK","CUSTOM","BEFORE","SUCCESS","WARN","HTML_CONTEXT","HEADER","BODY","Selector","MENU_HEADER","MENU_BODY","ACTIVE","LEFT_MENU","BODY_CLASS","Menu","element","_element","config","getConfig","init","data","attr","$header","$body","length","flag","chain","Date","getTime","select","$a","find","headerDiv","replace","RegExp","appendTo","trigger","$b","bodyDiv","on","click","closeLable","chk","Tool","eval","cus","fuc","rescus","call","args","warn","confirm","Confirm","ok","_chainOver","show","$this","bef","obj","event","preventDefault","target","closest","close","currentTarget","open","menuId","$round","prev","next","$preva","hasClass","eq","remove","addClass","prevSelect","$prevbody","closeOther","each","_index","ele","id","closeAll","menuid","siblings","removeClass","menu","menu$a","bData","extend","array","ckey","indexOf","push","key","Ajax","getHTML","suc","err","result","content","html","initUI","_jQueryInterface","Constructor","noConflict"],"mappings":"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"}