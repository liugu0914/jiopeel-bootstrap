{"version":3,"file":"initui.js","sources":["../src/initUI.js"],"sourcesContent":["import $ from 'jquery'\nimport Ajax from './ajax.js'\nimport Confirm from './confirm.js'\nimport Toast from './toast.js'\nimport Tool from './tool.js'\n\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\n\nconst NAME                = 'initUI'\nconst VERSION             = '1.0.0'\nconst DATA_KEY            = 'lyc.init'\nconst EVENT_KEY           = `.${DATA_KEY}`\nconst DATA_INFO            = `${DATA_KEY}.`\nconst DATA_API_KEY        = '.data-api'\nconst JQUERY_NO_CONFLICT  = $.fn[NAME]\n\nconst Selector = {\n  MENU      : '[target=\"menu\"]',\n  TAB       : '[target=\"tab\"]',\n  SEARCH    : '[target=\"search\"]',\n  SELECT    : '[target=\"select\"]',\n  QUERY     : '[target=\"query\"]',\n  FORM      : '[target=\"form\"]',\n  AJAX      : '[target=\"ajax\"]',\n  HTML      : '[target=\"html\"]',\n  CLEAR     : '[target=\"clear\"]',\n  PAGE      : '[target=\"page\"]',\n  TOOLTIP   : '[show=\"tooltip\"]',\n  ERROR_IMG : 'img[src-error]',\n  WARN      : 'warn'\n\n}\n\nconst Event = {\n  CLICK_QUERY       : `click.query${EVENT_KEY}${DATA_API_KEY}`,\n  CLICK_FORM        : `click.form${EVENT_KEY}${DATA_API_KEY}`,\n  CLICK_AJAX        : `click.ajax${EVENT_KEY}${DATA_API_KEY}`,\n  CLICK_DATA_API    : `click${EVENT_KEY}${DATA_API_KEY}`,\n  CHANGE_DATA_API   : `change${EVENT_KEY}${DATA_API_KEY}`,\n  ERROR_IMG         : `error.img${EVENT_KEY}${DATA_API_KEY}`\n}\n\nconst ClassName = {\n  QUERY_MAIN     : '.query-main',\n  QUERY_DATA     : '.query-data',\n  MODAL_CONTENT  : '.modal-content',\n  PAGE_LINK      : '.page-link',\n  CHECK_ALL : '.chk-all',\n  CHECK     : '.chk'\n}\n\nconst Customer = {\n  CHECK          : 'chk',\n  CUSTOM         : 'cus',\n  BEFORE         : 'bef',\n  SUCCESS        : 'suc'\n}\n\nconst WinData = {\n  nextInit: 0,\n  nextHeight: 0,\n  winW: 767.98,\n  winM: 1024,\n  winH: 1200\n}\n\nconst DataKey = {\n  QUERY    :  `${DATA_INFO}query`\n}\n\n/**\n * ------------------------------------------------------------------------\n *  初始化方法 init()\n *  @author lyc\n *  @date 2020年06月04日17:48:50\n * ------------------------------------------------------------------------\n */\n\nclass InitUI {\n  constructor(element) {\n    this._element = element\n    this.verifyJQuery()\n    // this.resizeWin()\n    this.imgError()\n    this.tooltip()\n    if (this.verifySelect2()) {\n      this.search()\n      this.select()\n    }\n    this.clear()\n    this.checkbox()\n    this.query()\n    this.form()\n    this.ajax()\n    this.page()\n  }\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  verifyJQuery() {\n    if (!$ || !$.fn) {\n      throw new TypeError('JQuery is not load, plz check out')\n    }\n  }\n\n  resizeWin() {\n    if (this._element !== document) {\n      return\n    }\n    $(window).on('resize', () => {\n      const winWidth = window.innerWidth\n      const $body = $('body')\n      const enlarged = 'enlarged'\n      // var sidebar = 'sidebar-enable';\n      if (winWidth > WinData.winM) {\n        $body.attr('class', '')\n      }\n      if (winWidth <= WinData.winM) {\n        $body.attr('class', enlarged)\n      }\n      if (winWidth <= WinData.winW) {\n        $body.attr('class', '')\n      }\n    })\n    $(window).trigger('resize')\n  }\n\n  // ----------------------------------------------------------------------\n  //  图片错误加载\n  // ----------------------------------------------------------------------\n  imgError() {\n    $(Selector.ERROR_IMG, this._element).each((index, element) => {\n      const $this = $(element)\n      let src = $this.attr('src')\n      $this.on(Event.ERROR_IMG, () => {\n        const attr = $this.attr('src-error')\n        if (!attr) {\n          src = '/img/user.png'\n        }\n        if (attr === 'user') {\n          src = '/img/user.png'\n        } else if (attr === 'img') {\n          src = '/img/img.png'\n        }\n        return src\n      })\n      return src && src !== window.location.href ? $this.attr('src', src) : $this.trigger(Event.ERROR_IMG)\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  提示插件 需要tooltip.js\n  // ----------------------------------------------------------------------\n  tooltip() {\n    if ($.fn.tooltip) {\n      $(Selector.TOOLTIP, this._element).tooltip({\n        bgcolor : 'dark'\n      })\n    }\n  }\n\n  // ----------------------------------------------------------------------\n  //  验证是否存在select2插件\n  //  给select2插件中文国际化\n  // ----------------------------------------------------------------------\n  verifySelect2() {\n    if (!$.fn.select2) {\n      // eslint-disable-next-line no-console\n      console.error('the select2 plugin do not loaded')\n      return false\n    }\n    if ($.fn.select2.amd) {\n      const e = $.fn.select2.amd\n      e.define('select2/i18n/zh-CN', [], () => ({\n        errorLoading() {\n          return '无法载入结果。'\n        },\n        inputTooLong(e) {\n          const t = e.input.length - e.maximum\n          const n = `请删除${t}个字符`\n          return n\n        },\n        inputTooShort(e) {\n          const t = e.minimum - e.input.length\n          const n = `请再输入至少${t}个字符`\n          return n\n        },\n        loadingMore() {\n          return '载入更多结果…'\n        },\n        maximumSelected(e) {\n          const t = `最多只能选择${e.maximum}个项目`\n          return t\n        },\n        noResults() {\n          return '未找到结果'\n        },\n        searching() {\n          return '搜索中…'\n        }\n      }))\n    }\n    return true\n  }\n\n  // ----------------------------------------------------------------------\n  //  select2插件ajax获取数据\n  // ----------------------------------------------------------------------\n  search() {\n    $(Selector.SEARCH, this._element).each((index, element) => {\n      const $this = $(element)\n      const id = $this.data('id')\n      const text = $this.data('text')\n      const op = {\n        placeholder :'请选择',\n        // allowClear : true,\n        ajax: {\n          url: $this.data('url'),\n          delay: 250,\n          data(params) {\n            let query = {\n              search: params.term\n            }\n            query = $.extend(query, $this.data())\n            return query\n          },\n          dataType: Ajax.JSON,\n          type: Ajax.POST,\n          processResults(result) {\n            let data = []\n            if (result.data) {\n              data = $.map(result.data, (obj) => {\n                obj.text = obj.text || obj.name\n                return obj\n              })\n            }\n            return {\n              results: data\n            }\n          }\n        },\n        templateSelection: formatState,\n        templateResult: formatState,\n        minimumInputLength: 0,\n        maximumSelectionLength: 100\n      }\n      function formatState(state) {\n        const pattern = /<(?:[^\"'>]|\"[^\"]*\"|'[^']*')*>/g\n        if (!state.id) {\n          return state.text\n        }\n        return state.text && pattern.test(state.text) ? $(state.text) : state.text\n      }\n      $this.select2(op)\n      if ($this.hasClass('select2-hidden-accessible') && id) {\n        const option = new Option(text, id, true, true)\n        $this.append(option).trigger('change')\n      }\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  select2前台数据(相当于原生select)\n  //  目的在于统一样式\n  // ----------------------------------------------------------------------\n  select() {\n    $(Selector.SELECT, this._element).each((index, element) => {\n      $(element).select2({\n        minimumResultsForSearch: Infinity\n      })\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  重置form表单元素\n  // ----------------------------------------------------------------------\n  clear() {\n    $(Selector.CLEAR, this._element).on(Event.CLICK_DATA_API, (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      const $this = $(event.currentTarget)\n      let $form\n      if ($this.closest('form').length !== 0) {\n        $form = $this.closest('form')\n      } else if ($this.closest(ClassName.QUERY_MAIN).find('form').length !== 0) {\n        $form = $this.closest(ClassName.QUERY_MAIN).find('form')\n      } else if ($this.closest(ClassName.MODAL_CONTENT).find('form').length !== 0) {\n        $form = $this.closest(ClassName.MODAL_CONTENT).find('form')\n      } else {\n        return\n      }\n      const attrs = $form.find('input,select,textarea')\n      attrs.each((index, element) => {\n        const $this = $(element)\n        if ($this.hasClass('select2-hidden-accessible')) {\n          const target = $this.attr('target')\n          if (target === 'search') {\n            return $this.empty()\n          }\n          if (target === 'select') {\n            return $this.select2('val', ' ')// 预留空格\n          }\n        }\n        return $this.val('')\n      })\n    })\n  }\n\n  checkbox() {\n    $(ClassName.CHECK_ALL, this._element).each((index, element) => {\n      const $this = $(element)\n      const $querydata = $this.closest(ClassName.QUERY_DATA)\n      const chks = $querydata.find('.chk')\n      $this.on(Event.CLICK_DATA_API, (event) => {\n        chks.prop('checked', $(event.target).prop('checked'))\n      })\n      chks.on(Event.CHANGE_DATA_API, () => {\n        const ischked = $querydata.find('.chk:checked')\n        if (ischked.length === 0) {\n          $this.prop('indeterminate', false)\n          $this.prop('checked', false)\n          return\n        }\n\n        if (ischked.length !== 0 && chks.length === ischked.length) {\n          $this.prop('indeterminate', false)\n          $this.prop('checked', true)\n          return\n        }\n        if (ischked.length !== 0 && chks.length !== ischked.length) {\n          $this.prop('indeterminate', true)\n        }\n      })\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  主页面查询表单控件\n  // ----------------------------------------------------------------------\n  query() {\n    $(Selector.QUERY, this._element).on(Event.CLICK_QUERY, (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      const $this = $(event.currentTarget)\n      $this.blur()\n      let $form\n      if ($this.closest('form').length !== 0) {\n        $form = $this.closest('form')\n      } else if ($this.closest(ClassName.QUERY_MAIN).find('form').length !== 0) {\n        $form = $this.closest(ClassName.QUERY_MAIN).find('form')\n      } else {\n        return\n      }\n      const config = {\n        ...$form.data(),\n        ...$this.data(),\n        ...{\n          url : $form.attr('action'),\n          data : Tool.formData($form),\n          type: Ajax.POST,\n          dataType: Ajax.HTML\n        }\n      }\n      $this.closest(ClassName.QUERY_MAIN).data(DataKey.QUERY)\n      this._ajaxUseful($this, config)\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  用于form提交\n  // ----------------------------------------------------------------------\n  form() {\n    $(Selector.FORM, this._element).on(Event.CLICK_FORM, (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      const $this = $(event.currentTarget)\n      $this.blur()\n      let $form\n      if ($this.closest('form').length !== 0) {\n        $form = $this.closest('form')\n      } else if ($this.closest(ClassName.MODAL_CONTENT).find('form').length !== 0) {\n        $form = $this.closest(ClassName.MODAL_CONTENT).find('form')\n      } else {\n        return\n      }\n      const config = {\n        ...$form.data(),\n        ...$this.data(),\n        ...{\n          url : $form.attr('action'),\n          data : Tool.formData($form),\n          type: Ajax.POST,\n          dataType: Ajax.JSON\n        }\n      }\n      this._ajaxUseful($this, config)\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  普通ajax交互\n  // ----------------------------------------------------------------------\n  ajax() {\n    $(Selector.AJAX, this._element).on(Event.CLICK_AJAX, (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      const $this = $(event.currentTarget)\n      $this.blur()\n      const data = $this.data()\n      const config = {\n        ...data,\n        ...{\n          url : $this.attr('href') || $this.data('url'),\n          data,\n          type: Ajax.POST,\n          dataType: Ajax.JSON\n        }\n      }\n      this._ajaxUseful($this, config)\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  ajax 返回html\n  // ----------------------------------------------------------------------\n  html() {\n    $(Selector.HTML, this._element).on(Event.CLICK_AJAX, (event) => {\n      if (event) {\n        event.preventDefault()\n      }\n      const $this = $(event.currentTarget)\n      $this.blur()\n      const data = $this.data()\n      const config = {\n        ...data,\n        ...{\n          url : $this.attr('href') || $this.data('url'),\n          data,\n          type: Ajax.POST,\n          dataType: Ajax.HTML\n        }\n      }\n      this._ajaxUseful($this, config)\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  分页器js处理\n  // ----------------------------------------------------------------------\n  page() {\n    $(Selector.PAGE, this._element).each((index, element)  => {\n      const $main = $(element).closest(ClassName.QUERY_MAIN)\n      const op = $main.data(DataKey.QUERY) || {\n        data :{}\n      }\n      $(element).find(ClassName.PAGE_LINK).on(Event.CHANGE_DATA_API, (event) => {\n        if (event) {\n          event.preventDefault()\n        }\n        const $this = $(event.target)\n        const pageNum = $this.data('pagenum')\n        op.data.pageNum = pageNum\n        Ajax.send(op)\n      })\n    })\n  }\n\n  // ----------------------------------------------------------------------\n  //  ajax默认success方法\n  // ----------------------------------------------------------------------\n  _suc($this, config) {\n    if (config.dataType === Ajax.HTML) {\n      return function (result) {\n        if (!config.target) {\n          return\n        }\n        const $target = ($this.closest(ClassName.QUERY_MAIN) || document).find(`${config.target}:first`)\n        $target.data(DATA_KEY, new InitUI($target.html(result)[0]))\n      }\n    }\n    return function (result) {\n      if (!result || typeof result !== 'object') {\n        return Toast.err('未知错误')\n      }\n      // 后台返回参数 result\n      const flag = result.result\n      if (flag) {\n        $('#modal').modal('hide')\n        $('#query').trigger('click')\n      }\n      return flag ? Toast.suc(result.message) : Toast.err(result.message)\n    }\n  }\n\n  // ----------------------------------------------------------------------\n  //  通用处理Customer中的事件\n  //  事件顺序:[chk , cus, bef ,suc]\n  // ----------------------------------------------------------------------\n  _ajaxUseful($this, config) {\n    const chk = Tool.eval(config[Customer.CHECK])\n    if (typeof chk === 'function') {\n      const flag = chk($this, config.data)\n      if (typeof flag === 'boolean' && !flag) {\n        return\n      }\n    }\n    // 自定义函数式  用于封装数据\n    const cus = Tool.eval(config[Customer.CUSTOM])\n    if (cus && typeof cus === 'object' && typeof cus.fuc === 'function') {\n      const rescus = cus.fuc.call($this[0], ...cus.args)\n      if (rescus && typeof rescus === 'object') {\n        config.data = {\n          ...config.data,\n          ...rescus\n        }\n      } else if (typeof rescus === 'boolean' && !rescus) {\n        return\n      }\n    }\n\n    const warn = config[Selector.WARN]\n    if (warn) {\n      const confirm  = new Confirm(warn)\n      confirm.ok(() => this._ajaxUsefulMain($this, config)).show()\n    } else {\n      this._ajaxUsefulMain($this, config)\n    }\n  }\n\n  // ----------------------------------------------------------------------\n  //  通用处理Customer中的事件\n  //  事件顺序:[chk , cus, bef ,suc]\n  // ----------------------------------------------------------------------\n  _ajaxUsefulMain($this, config) {\n    const bef = Tool.eval(config[Customer.BEFORE])\n    if (typeof bef === 'function') {\n      const obj = bef($this, config.data)\n      config.data = {\n        ...config.data,\n        ...typeof obj === 'object' && obj ? obj : {}\n      }\n    }\n    let suc = Tool.eval(config[Customer.SUCCESS])\n    if (typeof suc !== 'function') {\n      suc = this._suc($this, config)\n    }\n    config.success = suc\n    Ajax.send(config)\n  }\n\n  // ----------------------------------------------------------------------\n  //  默认启动方法init()\n  // ----------------------------------------------------------------------\n  static _init() {\n    return this.each(function () {\n      let data = $(this).data(DATA_KEY)\n      if (!data) {\n        data = new InitUI(this)\n        $(this).data(DATA_KEY, data)\n      }\n    })\n  }\n}\n\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n$.fn[NAME] = InitUI._init\n$.fn[NAME].Constructor = InitUI\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return InitUI._init\n}\nexport default InitUI\n"],"names":["NAME","VERSION","DATA_KEY","EVENT_KEY","DATA_INFO","DATA_API_KEY","JQUERY_NO_CONFLICT","$","fn","Selector","MENU","TAB","SEARCH","SELECT","QUERY","FORM","AJAX","HTML","CLEAR","PAGE","TOOLTIP","ERROR_IMG","WARN","Event","CLICK_QUERY","CLICK_FORM","CLICK_AJAX","CLICK_DATA_API","CHANGE_DATA_API","ClassName","QUERY_MAIN","QUERY_DATA","MODAL_CONTENT","PAGE_LINK","CHECK_ALL","CHECK","Customer","CUSTOM","BEFORE","SUCCESS","WinData","nextInit","nextHeight","winW","winM","winH","DataKey","InitUI","element","_element","verifyJQuery","imgError","tooltip","verifySelect2","search","select","clear","checkbox","query","form","ajax","page","TypeError","resizeWin","document","window","on","winWidth","innerWidth","$body","enlarged","attr","trigger","each","index","$this","src","location","href","bgcolor","select2","console","error","amd","e","define","errorLoading","inputTooLong","t","input","length","maximum","n","inputTooShort","minimum","loadingMore","maximumSelected","noResults","searching","id","data","text","op","placeholder","url","delay","params","term","extend","dataType","Ajax","JSON","type","POST","processResults","result","map","obj","name","results","templateSelection","formatState","templateResult","minimumInputLength","maximumSelectionLength","state","pattern","test","hasClass","option","Option","append","minimumResultsForSearch","Infinity","event","preventDefault","currentTarget","$form","closest","find","attrs","target","empty","val","$querydata","chks","prop","ischked","blur","config","Tool","formData","_ajaxUseful","html","$main","pageNum","send","_suc","$target","Toast","err","flag","modal","suc","message","chk","eval","cus","fuc","rescus","call","args","warn","confirm","Confirm","ok","_ajaxUsefulMain","show","bef","success","_init","Constructor","noConflict"],"mappings":"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"}